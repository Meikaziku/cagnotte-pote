{% extends 'base.html.twig' %}

{% block title %}Hello ShowController!
{% endblock %}

{% block body %}
	<div class="navbar-fixed">
		<nav class="white">
			<div class="nav-wrapper">
				<a href="/" class="brand-logo center">Cagnot'Potes</a>
				<ul class="right hide-on-med-and-down">
					<li>
						<a href="{{ path(name = 'app_campaign_new') }}" class="waves-effect waves-light btn pink lighten-1">Créer une campagne</a>
					</li>
				</ul>

				<ul id="nav-mobile" class="sidenav">
					<li>
						<a href="{{ path(name = 'app_campaign_new') }}" class="waves-effect waves-light btn pink lighten-1">Créer une campagne</a>
					</li>
				</ul>

				<ul class="right hide-on-med-and-down">
					<li>
						<a href="{{ path(name = 'app_logout') }}" class="waves-effect waves-light btn blue lighten-1">Logout</a>
					</li>
				</ul>

				<ul id="nav-mobile" class="sidenav">
					<li>
						<a href="{{ path(name = 'app_logout') }}" class="waves-effect waves-light btn blue lighten-1">Logout</a>
					</li>
				</ul>
				<a href="#" data-target="nav-mobile" class="sidenav-trigger">
					<i class="material-icons">menu</i>
				</a>
			</div>
		</nav>
	</div>

	<div class="parallax-container valign-wrapper">
		<div class="section no-pad-bot">
			<div class="container">
				<h1 class="header center white-text light">{{ campaign.title }}</h1>
				<div class="row center">
					<h5 class="header col s12 light">- Organisée par :
						{{ campaign.name }}
						-</h5>
				</div>
			</div>
		</div>
		<div class="parallax"><img src="{{ asset('images/8.jpg') }}" alt="Titre de la campagne"></div>
	</div>

	<!-- Show progress -->
	<section class="progress-section">
		<div class="progress">
			{% set total = 0 %}
			{% for participation in campaign.participations %}
				{% if participation.payment %}
					{% set total = total + participation.payment.amount %}
				{% endif %}
			{% endfor %}
			{% set percentage = campaign.goal > 0 ? (total / campaign.goal * 100)|round : 0 %}
			<div class="determinate" style="width: {{ percentage }}%">
				<span>{{ percentage }}% de l'objectif ({{ total }}
					€ /
					{{ campaign.goal }}
					€)</span>
			</div>
		</div>
	</section>
	<!-- Participation section -->
	<div class="row">
		<div class="card col s12 m12 l8 offset-l2">
			<div class="card-content">
				<div class="input-field col s12 l6">
					<input id="mount" type="number" class="validate">
					<label for="mount">Votre participation</label>
				</div>
				<a href="{{ path('app_campaign_payment', {'id': campaign.id}) }}" class="btn-large waves-effect waves-light pink lighten-1 col s12 l6">Participer</a>
				<div class="clearfix"></div>
			</div>
		</div>
	</div>
	<div class="row">
		<div class="col s12 center">
			<h4>A propos de la campagne</h4>
		</div>
	</div>
	<!--   Icon Section   -->
	<div class="row">
		<div class="col s12 m6 l3 offset-l3">
			<div class="icon-block center">
				<div class="btn-large btn-floating white">
					<i class="material-icons teal-text">person</i>
				</div>
				<h3 class="center">{{ campaign.participations|length }}</h3>
				<p class="light">Participants</p>
			</div>
		</div>

		<div class="col s12 m6 l3">
			<div class="icon-block center">
				<div class="btn-large btn-floating white">
					<i class="material-icons teal-text">euro_symbol</i>
				</div>
				<h3 class="center">
					{% set total = 0 %}
					{% for participation in campaign.participations %}
						{% if participation.payment %}
							{% set total = total + participation.payment.amount %}
						{% endif %}
					{% endfor %}
					{{ total|number_format(0, ',', ' ') }}
					€
				</h3>
				<p class="light">Total collecté</p>
			</div>
		</div>
	</div>
	<!-- Form section -->
	<div class="row">
		<form>
			<div class="input-field col s12">
				<label for="description">Description</label>
				<textarea id="description" class="materialize-textarea" readonly="readonly">{{ campaign.content }}</textarea>
			</div>
			<div class="input-field col s12 l6">
				<label for="goal">Goal</label>
				<input id="goal" type="number" readonly="readonly" value="{{ campaign.goal }}">
			</div>
			
		</form>
	</div>
	<!-- List -->
	<div class="row">
	{# {{ app.user.email }} #}
    <div class="col s12 center">
        <h4>Top 3 des plus gros donateurs</h4>
    </div>

    <div class="col s12">
        <table class="highlight responsive-table">
            <thead>
                <tr>
                    <th>Email</th>
                    <th>Participation</th>
                </tr>
            </thead>
            <tbody>
                {% for participation in top_donors %}
                    <tr>
                        <td>{{ participation.user.email }}</td>
                        <td>{{ participation.payment.amount|number_format(2, ',', ' ') }} €</td>
                    </tr>
                {% else %}
                    <tr>
                        <td colspan="2" class="center">Aucun donateur pour le moment</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
</div></div><div class="parallax-container valign-wrapper">
<div class="section no-pad-bot">
	<div class="container">
		<div class="row center">
			<h4 class="header col s12 light">Une campagne pensée pour vous<br>et pour toutes les occasions</h4>
		</div>
	</div>
</div>
<div class="parallax"><img src="{{ asset('images/10.jpg') }}" alt="Une campagne pensée pour vous"></div></div><footer class="page-footer teal">
<div class="container">
	<div class="row">
		<div class="col l6 s12">
			<h5 class="white-text">Cagnot'Potes</h5>
			<p class="grey-text text-lighten-4">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam scelerisque id nunc nec volutpat. Etiam pellentesque tristique arcu, non consequat magna fermentum ac. Cras ut ultricies eros. Maecenas eros justo.</p>
		</div>
		<div class="col l3 s12 offset-l3">
			<h5 class="white-text">Liens</h5>
			<ul class="footer-links">
				<li>
					<a class="white-text" href="#!">Comment ça marche ?</a>
				</li>
				<li>
					<a class="white-text" href="#!">Voir les campagnes</a>
				</li>
				<li>
					<a class="white-text" href="{{ path(name = 'app_campaign_new') }}">Créer une campagne</a>
				</li>
			</ul>
		</div>
	</div>
</div>
<div class="footer-copyright">
	<div class="container">
				fait par Yanis
				<a class="white-text" href="http://trombi.simplon-roanne.com/">Simplon Saint-Etienne</a>
			</div>
</div></footer><!--JavaScript at end of body for optimized loading--><script type="text/javascript" src=" {{ asset('js/materialize.min.js') }}"></script><!--Init & custom scripts--><script type="text/javascript" src="{{ asset('js/scripts.js') }}"></script>{% endblock %}
